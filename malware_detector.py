
import hashlib

def check_malware(filepath):
    known_hashes = set()
    with open('malware_hashes.txt', 'r') as f:
        for line in f:
            known_hashes.add(line.strip())

    with open(filepath, 'rb') as file:
        file_hash = hashlib.sha256(file.read()).hexdigest()
    return file_hash in known_hashes
